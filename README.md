# QRコード[*]生成
[*]: QRコードは株式会社デンソーウェーブの登録商標です 
入力されたテキストと設定からQRコードを生成する

実装は[こちら](https://qr-generator-two-tawny.vercel.app/)にデプロイしている（初回の生成はバックエンドサーバ起動のため少々時間がかかる可能性あり）

## バックエンド
pythonにより実装

### 生成の流れ
1. 入力された文のエンコード
    * 以下4つのモードを用いる
        * 数字モード：0~9の数字
        * 英数字モード：数字と大文字のアルファベット、数種類の記号
        * 8ビットバイトモード：JIS X 0208で表現できる文字
        * 漢字モード：JIS X 0208のうち漢字に相当する領域の文字
    * 入力文字に応じて以上のモードを混在させてエンコードする
        * 現在の実装では対象の文字を最小のビット数でエンコードできるモードを選択するようになっている
    * `encode.py`にて実装

1. 型番の選択
    * QRコードは型番によってサイズ（＝マス目の数）が決まっている
    * 入力された文字の長さとエラー訂正レベルに応じて型番を決定する
        * 現在の実装ではコードを格納できる最小の型番を選択するようになっている
    * `midcode.py`にて実装

1. エラー訂正コード生成
    * 多少の汚れ等に対する頑健性のため、リードソロモン符号を追加しコードに冗長性を持たせる
    * 生成されるコード長はエラー訂正レベルに依存する
    * リードソロモン符号において濃度$2^8$のガロア体$\mathrm{GF}(2^8)$を用いるため、`gf256.py`においてそれに相当するクラスを作成
    * 生成は`errorcode.py`にて行っている

1. 一時コード描画
    * 生成されたデータコードとエラー訂正コードを描画する
    * `qrprint.py`にて実装

1. マスキング
    * 極端に白ばかりのコードなどが生成されないよう、8種類のマスクの中から適切なものを選択してマスキングする
    * `mask.py`にて実装

1. その他パターン描画
    * データ以外に必要なパターンの描画を行う
    * `qrprint.py`にて実装

1. 出力
    * 画像ファイルの出力
    * API用にビットパターンのバッファのみの出力

### API
FastAPIを使用
* フロントエンドからのリクエストを受け、QRコードを生成し、Blobを返す
* CORSはフロントエンドのオリジンのみ許可

## フロントエンド
JavaScript + Viteで実装
* html内でテキスト入力、形式等の入力をしたうえで「生成」ボタンを押すとAPIに対してリクエストが送信され、生成されたQRコードのBlobが返る
* Blobからダウンロード用のリンクを生成し、プレビューの表示、およびダウンロードボタンの有効化を行う
* 「誤り訂正レベル」という言葉はユーザに聞きなじみがないと思われるため、popoverを使用して説明用のツールチップを作成
* コードサイズによっては生成までに少々時間がかかる場合があるため、生成ボタンを押した際にプレビュー欄にローディングアニメーションが表示されるようにした
* できるだけレスポンシブなデザインにするため、メディアクエリ等を用いたレイアウトの実装を行った